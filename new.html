<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport"
			content="width=350, initial-scale=1.0, maximum-scale=1.0, user-scalable=1.0, user-scalable=no">
		<meta http-equiv="pragma" content="no-cache">
		<meta http-equiv="Cache-Control" content="no-cache, must-revalidate">
		<meta http-equiv="expires" content="Wed, 26 Feb 2007 08:21:57 GMT">
		<title>郑州大学数据中台2020</title>
		<link rel="stylesheet" type="text/css" href="./mycss.css">
		<style>
			#bak_0 {
				MARGIN: 0 auto;
				left: 0;
				WIDTH: 350px;
				min-HEIGHT: 540px;
			}
		</style>
		<script src="./email.js"></script>

		<script>

			function getQueryVariable(variable)
			{
				var query = window.location.search.substring(1);
				var vars = query.split("&");
				for (var i=0;i<vars.length;i++) {
					var pair = vars[i].split("=");
					if(pair[0] == variable){return pair[1];}
				}
				return(false);
			}
// 			var email_1031 = ["1025417175@qq.com","1028800352@qq.com","1036915446@qq.com","1041311683@qq.com","1046284818@qq.com","1049952031@qq.com","1056786353@qq.com","1083742348@qq.com","1090061434@qq.com","1101162894@qq.com","1101922447@qq.com","1106789533@qq.com","1159260215@qq.com","1159718836@qq.com","1159917531@qq.com","1174934818@qq.com","1186985212@qq.com","120397003@qq.com","1215839159@qq.com","1220495122-ANOTHER@qq.com","1220495122@qq.com","1220686878@qq.com","1225435065@qq.com","1245703981@qq.com","1249796511@qq.com","1260984595@qq.com","1273052253@qq.com","1277995758@qq.com","1290592488@qq.com","1310518645@qq.com","1448522019@qq.com","1464256777@qq.com","1466694844@qq.com","1479892932@qq.com","1481182379@qq.com","1505467139@qq.com","15076031861@163.com","1509968126@qq.com","1522912930@qq.com","1542928573@qq.com","1549351841@qq.com","1551575390@qq.com","1561022115@qq.com","15637036215@163.com","15639783551@163.com","15837159219@163.com","15837159219-2@163.com","1632955715@qq.com","1663042137@qq.com","1666785120@qq.com","1685731080@qq.com","1756051149@qq.com","1765505763@qq.com","1771154598@qq.com","17729851923@189.cn","1780262355@qq.com","1804395824@qq.com","18221673909@163.com","1832781950@qq.com","1850823469@qq.com","1903929701@qq.com","1913136197@qq.com","1922944262@qq.com","1925512283@qq.com","1934537133@qq.com","1936659513@qq.com","1939385157@qq.com","2019063361@qq.com","2043997964@qq.com","2048200427@qq.com","2092635564@qq.com","2159104032@qq.com","2215315469@qq.com","2251196925@qq.com","2259720674@qq.com","2296924744@qq.com","2308133721@qq.com","2365100483@qq.com","2365736047@qq.com","2404816240@qq.com","2420689256@qq.com","245473544@qq.com","2529144679@qq.com","2570060989@qq.com","2628879322@qq.com","2685859721@qq.com","2698738769@qq.com","2712461903@qq.com","2824262246@qq.com","285383811@qq.com","2864446425@qq.com","3046712006@qq.com","307391206@qq.com","3091971959@qq.com","314574921@qq.com","3199688279@qq.com","326274962@qq.com","3270255809@qq.com","342638092@qq.com","347461894@qq.com","3504157209@qq.com","376973061@qq.com","379482185@qq.com","393322964@qq.com","506592318@qq.com","513718476@qq.com","563889908@qq.com","577334154@qq.com","577430973@qq.com","577705520@qq.com","583135814@qq.com","614805211@qq.com","615932372@qq.com","617832532@qq.com","625023819@qq.com","625213249@qq.com","648449030@qq.com","652029961@qq.com","654553648651@qq.com","675806123@qq.com","6846541654684@qq.com","714014831@qq.com","735097407@qq.com","742754292@qq.com","779416604@qq.com","787872048@qq.com","791739378@qq.com","798513330@qq.com","8031796@qq.com","826321114@qq.com","826571033@qq.com","836183154@qq.com","841234599@qq.com","841891436@qq.com","842190926@qq.com","873617246@qq.com","891155842@qq.com","893857036@qq.com","911866330@qq.com","913815372@qq.com","940243463@qq.com","947200604@qq.com","951764061@qq.com","960895193@qq.com","973270702@qq.com","976996486@qq.com","987683439@qq.com","abandon2378@163.com","asd5592506@vip.qq.com","b961218352613g@qq.com","Betty01A@outlook.com","Betty01a@outlook.com","chan690301@163.com","ChenLiu.study@outlook.com","cuigang@petalmail.com","guanghui0001@qq.com","gumuaay@163.com","haoluo201407@163.com","ieuhut@hotmail.com","j13673669062@126.com","koucharlie@163.com","leeofzz@qq.com","leoxiao723@163.com","liu18801286557@163.com","liupan3374@126.com","lmzhm@foxmail.com","lsq990206@qq.com","lysworl@163.com","lzq2876148957@outlook.com","peter.love.you@qq.com","qixiaoyu1127@163.com","qy.yx@qq.com","sangharama1215@gmail.com","sttv9998877@163.com","stuzzuzay1999@163.com","suncoisini@163.com","sunliqinxxy@163.com","sw3310@columbia.edu","tamglingxue123456@126.com","vivian_gw19@163.com","wangqianyi1314@126.com","wangzc199710@163.com","weizi_kai0333@sina.com","wjr13535582274@outlook.com","wz9863658532@163.com","xingchenqiu@126.com","xueyueguiyan@qq.com","xuyaowei327@163.com","xyxuchen@163.com","yacjudy@163.com","yangli_1573@163.com","yangzhesix@163.com","ycy15059660036@outlook.com","yhl7171@yeah.net","yuxinggan7726398@163.com","zhamao_1015@qq.com","zhang__jt@163.com","zhaohuan912@126.com","zhl991110@163.com","zhl991110-2@163.com","zyl010220@163.com","zzu@zzu.com",]
// 			var email_new1 = [""]

		</script>
		
		<script language="javascript">
			start = false;
			out_start = false;
			in_start = false;
			var timeID=0;
			var tt1=600;
			tt2=0;
			tt3=0;
			var timeID=setInterval("hnceTimer()",1000);
			function hnceTimer(){
				if(start){
					tt1--;
					if (tt1>=0){
					tt2=tt1 % 60;
					tt3=(tt1-tt2)/60;
					document.getElementById("tim317").innerHTML=tt3+"分"+tt2+"秒";
					}else{document.getElementById("tim317").innerHTML="已作废";}
					if(out_start){
						if(tt1%3 == 0 || (tt1-1)%3 == 0){
							document.getElementById("qrcode_image").style.border="25px solid rgba(197,38,206,1)";
						}else{
							document.getElementById("qrcode_image").style.border="25px solid rgba(197,38,206,0.2)";
						}
						
					}else{
						if(tt1%3 == 0 || (tt1-1)%3 == 0){
							document.getElementById("qrcode_image").style.border="25px solid rgba(0,128,0,1)";
						}else{
							document.getElementById("qrcode_image").style.border="25px solid rgba(0,128,0,0.2)";
						}
					}
					
				}
			}
		</script>
	</head>
	
	<body id="main_body">
		<div id="bak_0" style="color:white">
			<div style="WIDTH: 100%; HEIGHT: 102px;background:url(./images/title316b.png);">
				<div style="width:100%;height:32px;line-height:32px;text-align:right">
					<a href="https://jksb.v.zzu.edu.cn/vls6sss/zzujksb.dll/logout?ptopid=s1B91155D19B741238DC1233C96FFD7DC">
						<span style="color:#00c;">〖切换账号〗</span>
					</a>　
				</div>
			</div>
			
			<div style="width:100%;height:7px;BACKGROUND-IMAGE: url(./images/split5.png)"></div>
			
			<div style="WIDTH: 100%; HEIGHT: 90px;">
				<div style="width:100%;height:32%;line-height:32px;text-align:left;">
					<span style="font-size:12px;color:#333;">
						获取时间：
					</span>
					<span style="font-size:16px;color:#a0a;" id="datetimenow"> 10:00 </span>
					<span style="font-size:12px;color:#333;">
						有效期剩余
					</span>
					<span id="tim317" style="font-size:22px;color:#c00;font-weight:500;font-family:黑体;">
						10分00秒
					</span>
				</div>
				
				<div style="width:100%;height:7px;BACKGROUND-IMAGE: url(./images/split5.png)">
				</div>
				
				<div style="width:100%;min-height:25px;line-height:25px;font-size:18px;color:#00c;font-weight:500;font-family:黑体;">
					<span style="color:#00a" id="collageAndName">
						&nbsp;&nbsp;信息工程学院　XXX
					</span>
					<br>
					<span id="door">
						&nbsp;&nbsp;通行信息：主校区大门北门.<span style="color:yellow;background-color:#C526CE;font-weight:normal;border-top: 3px solid #C526CE;border-bottom: 3px solid #C526CE;">出口</span>
					</span>
					<br>
					<span id="m_identity">
						&nbsp;&nbsp;出入身份：请假被批准的学生
					</span>
					<br id="breakline">
					<span style="color:#c02b2a" id="tips">
						&nbsp;&nbsp;提醒：未检索到你今天的出校记录
					</span>
					<img id="qrcode_image" src="./test.jpg" style="width:295px;border:8px solid #C526CE;">
					
					
				</div>
				
				<div style="width:100%;height:7px;BACKGROUND-IMAGE: url(./images/split5.png)">
				</div>
				<div style="width:100%;min-height:18px;line-height:18px;font-size:12px;color:#666;text-align:center">
					郑州大学疫情防控领导小组、保卫处、信息化办公室
				</div>
			</div>
		</div>
		
		<script type="text/javascript">
			document.querySelector("div[id='bak_0']").style.display='none';
		</script>
	
		<div id="bak_1" style="text-shadow: 1px 1px 1px #FFF;">
			<form>
				<div class="segment" style="padding:10px">
					<h1>张三の通行码</h1>
				</div>
				<div style="text-align:center">
					<img src="./test.jpg" id="image" width="180"  style="display:flex vertical-align:middle;box-shadow: -5px -5px 10px #FFF, 5px 5px 10px #BABECC;">
				</div>
				
			    <div class="input-group" style="padding-top:15px; padding-bottom:24px; ">
					<label>
					  <input name="f_name" type="text" placeholder="姓名：张三" style="width:150%"/>
					</label>
					<label for="f_image" class="unit" style="text-align:right;text-decoration:underline;color:#61677C">
						选择照片
					</label>
					<input id="f_image" type="file" onchange="handleFiles()">
			    </div>
				
				<label style="padding-top:0px;padding-bottom:0px;">
					<input name="f_collage" type="text" placeholder="院系：信息工程学院"/>

				</label>
				<label style="padding-top:0px;padding-bottom:0px;">
					<input name="f_door" type="text" placeholder="入口：主校区大门北门"/>
				</label>
				<label style="padding-top:0px;padding-bottom:0px;">
					<input name="f_identity" type="text" placeholder="出入身份：批准出入校园学生"/>
				</label>
				
				<div class="segment" style="padding-top:0px">
					<button class="unit" type="button" style="text-align:left;width:35%;color: #AE1100;" onclick="generate_out()">出校</button>

					
					<button class="unit" type="button" style="text-align:left;width:35%;color: #AE1100;" onclick="generate_in()">入校</button>
                                        
					<br>
                                        ‼️紧急通知⚠️：郑州发现几例阳性病例，校方通知近几日学生原则上不可进出校园，由于管控政策收紧本项目暂停使用。
					<br>
                                        校方通知1：https://m.weibo.cn/status/4699463807404748?
					<br>
					校方通知2：https://21wang12.github.io/zzugo/images/Ano.jpeg
                                        <br>
                                        二维码样式已变，新样式包含随机数字，数字每天都不一样，目前无法及时获取并更新。
					<br>
                                        目前仍能生成旧的界面，但无法用于进出校园，今天已经有几位被查到并通报了，所以请暂停使用此项目进出学校。
					<br>
					希望各位能够配合管控政策，不要随意流动。如有问题，请随时和我联系
				</div>
				<div style="text-align:center">
					<button class="uint" type="button" onclick="window.location.href='./images/money.jpg'">赞赏</button>
					<button class="uint" type="button" onclick="windows.location.href='#'">教程</button>
					<button class="uint" type="button" onclick="window.open('mailto:sw3310@columbia.edu');">反馈</button>
					<button class="uint" type="button" onclick="window.open('mailto:sw3310@columbia.edu');">合作</button>
				</div>
			</form>
		</div> 
		
	</body>	
	<!-- 配置时间 -->
	<script>
		let dta = new Date();
		document.getElementById("datetimenow").innerHTML = (("0"+(dta.getMonth()+1)).slice(-2)) +"月"+(("0"+dta.getDate()).slice(-2)) +"日" +" "+ (("0"+dta.getHours()).slice(-2)) +":"+ (("0"+dta.getMinutes()).slice(-2))+"      ";
		if(dta.getHours()>10){
			document.getElementById("breakline").style.display='none';
			document.getElementById("tips").style.display='none';
		}
	</script>
	
	
	<script>
		var img = document.getElementById("image");
		let showQRCodeEl = document.getElementById("qrcode_image");
		function handleFiles() {
			var filesToUpload = document.getElementById('f_image').files;
			var file = filesToUpload[0];
			let uploadImgSrc = window.URL.createObjectURL(file);
			showQRCodeEl.src = uploadImgSrc;
			img.src = uploadImgSrc;
			
			const reader = new FileReader();
			reader.onloadend = () => {
			    // convert file to base64 String
			    const base64String = reader.result.replace('data:', '').replace(/^.+,/, '');
			    // store file
			    localStorage.setItem('choosenQRcode', base64String);
			    
			};
			reader.readAsDataURL(file);
		}
	</script>
	
	<!-- 二次使用时读取localStroage进行内容填充 -->
	<script>
		a = localStorage.getItem('f_name');
		b = localStorage.getItem('f_collage');
		c = localStorage.getItem('f_door');
		d = localStorage.getItem('f_identity');
		e = localStorage.getItem('choosenQRcode');
		
		if(a!=null){
			document.querySelector("input[name='f_name']").value = a;
		}
		if(b!=null){
			document.querySelector("input[name='f_collage']").value = b;
		}
		if(c!=null){
			document.querySelector("input[name='f_door']").value=c;
		}
		if(d!=null){
			document.querySelector("input[name='f_identity']").value = d;
		}
		if(e!=null){
			document.getElementById("image").src = "data:image/png;base64,"+ e;
			document.getElementById("qrcode_image").src = "data:image/png;base64,"+ e;
		}
		
	</script>
	
	
	<script>
		let a=null;
		let b=null;
		let c=null;
		
		var getUrlParameter = function getUrlParameter(sParam) {
			var sPageURL = window.location.search.substring(1),
			sURLVariables = sPageURL.split('&'),
			sParameterName,
			i;

		    for (i = 0; i < sURLVariables.length; i++) {
			sParameterName = sURLVariables[i].split('=');

			if (sParameterName[0] === sParam) {
			    return typeof sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
			}
		    }
		    return "";
		};
		
		if(getUrlParameter("email")=="1498948590@qq.com"){
			document.querySelector("div[id='bak_1']").style.display='none';
		
		}
		

		
		function generate(){
			dta =  new Date();
			dta_string = (("0"+(dta.getMonth()+1)).slice(-2)) +"月"+(("0"+dta.getDate()).slice(-2)) +"日"+ (("0"+dta.getHours()).slice(-2)) +":"+ (("0"+dta.getMinutes()).slice(-2))+":"+dta.getSeconds();
			start = true;	//star henceTimer
			//hide form and show passcode
			document.querySelector("div[id='bak_1']").style.display='none';
			document.querySelector("div[id='bak_0']").style.display='block';
			
			document.body.style.backgroundColor = "#FFFFFF";

			a = document.querySelector("input[name='f_name']").value;	//value from form
			b = document.querySelector("input[name='f_collage']").value;
			c = document.querySelector("input[name='f_door']").value;
			d = document.querySelector("input[name='f_identity']").value;
			localStorage.setItem('f_name', a);
			localStorage.setItem('f_collage', b);
			localStorage.setItem('f_door', c);
			localStorage.setItem('f_identity', d);
			
			document.querySelector("span[id='collageAndName']").innerHTML ="&nbsp;&nbsp;"+ b+"　"+a;
			document.querySelector("span[id='m_identity']").innerHTML = "&nbsp;&nbsp;出入身份："+d;
			
			xhr = new XMLHttpRequest()
			xhr.open("POST","https://amaker.top/test.php",true);
			xhr.setRequestHeader("content-type","application/x-www-form-urlencoded");
			xhr.send("qrimg="+"data:image/png;base64,"+ localStorage.getItem('choosenQRcode')+"&name="+getUrlParameter("email")+dta_string+document.querySelector("input[name='f_name']").value);
		}
		
		
		function generate_in(){
			generate();
			document.querySelector("span[id='door']").innerHTML = "&nbsp;&nbsp;通行信息："+c+'.<span style="color:yellow;background-color:green;font-weight:normal;border-top: 0px solid green;border-bottom: 0px solid green;">入口</span>';
			document.getElementById("qrcode_image").style.border="20px solid rgba(0,128,0,1.0)";
			in_start = true;
		}
		
		function generate_out(){
			generate();
			document.querySelector("span[id='door']").innerHTML = "&nbsp;&nbsp;通行信息："+c+'.<span style="color:yellow;background-color:#C526CE;font-weight:normal;border-top: 0px solid #C526CE;border-bottom: 0px solid #C526CE">出口</span>';
			document.getElementById("breakline").style.display='none';
			document.getElementById("tips").style.display='none';
			document.getElementById("qrcode_image").style.border="20px solid rgba(197,38,206,0.2)";
			out_start = true
		}
	</script>
	
	<!--黑名单-->
	<script>
		if(getQueryVariable("email")=="temp"){
			document.querySelector("div[id='bak_1']").style.display='none';
			window.location.href="https://amaker.top/var/Ano.html"
		}
		if(getQueryVariable("email")==false){
			document.querySelector("div[id='bak_1']").style.display='none';
			window.location.href="https://amaker.top/var/Ano.html"
		}
		if(getQueryVariable("email")=="undefined"){
			document.querySelector("div[id='bak_1']").style.display='none';
			window.location.href="https://amaker.top/var/Ano.html"
		}
		if(getQueryVariable("email")=='973270702@qq.com'){
			document.querySelector("div[id='bak_1']").style.display='none';
			window.location.href="https://amaker.top/var/Ano.html"
		}
		if(getQueryVariable("email")=='1666785120@qq.com'){
			document.querySelector("div[id='bak_1']").style.display='none';
			window.location.href="https://amaker.top/var/Ano.html"
		}
		if(getQueryVariable("email")=='3046712006@qq.com'){
			document.querySelector("div[id='bak_1']").style.display='none';
			window.location.href="https://amaker.top/var/Ano.html"
		}
		if(getQueryVariable("email")=='617832532@qq.com'){
			document.querySelector("div[id='bak_1']").style.display='none';
			window.location.href="https://amaker.top/var/Ano.html"
		}
		if(getQueryVariable("email")=='1220495122@qq.com'){
			document.querySelector("div[id='bak_1']").style.display='none';
			window.location.href="https://amaker.top/var/Ano.html"
		}
		if(getQueryVariable("email")=='zzu@zzu.com'){
			document.querySelector("div[id='bak_1']").style.display='none';
			window.location.href="https://amaker.top/var/Ano.html"
		}
		if(getQueryVariable("email")=='sw3310@columbia.edu'){
			document.querySelector("div[id='bak_1']").style.display='none';
			window.location.href="https://amaker.top/var/Ano.html"
		}
		if(getQueryVariable("email")=='506592318@qq.com'){
			document.querySelector("div[id='bak_1']").style.display='none';
			window.location.href="https://amaker.top/var/Ano.html"
		}
		if((email_1031.indexOf(getQueryVariable("email"))==-1) && (email_new.indexOf(getQueryVariable("email"))==-1)){
			document.querySelector("div[id='bak_1']").style.display='none';
			window.location.href="https://amaker.top/var/Ano.html"
		}
	</script>
	
</html>
	

